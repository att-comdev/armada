endpoints: &endpoints
  glance:
    this: is an example

armada:

  # results in "armada-keystone" release name below
  # to avoid manipulating releases managed directtly
  # with helm or other armadas
  release_prefix: armada

  charts:
    # silent dependency
    - chart: &helm-toolkit
        name: helm-toolkit
        release_name: null
        namespace: null
        values: {}
        source:
          type: git
          location: git://github.com/gardlt/openstack-helm
          subpath: helm-toolkit
          reference: override-values
        dependencies: []

    - chart: &mariadb
        name: mariadb
        release_name: mariadb
        namespace: openstack
        install:
          no_hooks: false
        upgrade:
          no_hooks: false
        values:
          endpoints: *endpoints
        source:
          type: git
          location: git://github.com/gardlt/openstack-helm
          subpath: mariadb
          reference: override-values
        dependencies:
          - *helm-toolkit

    - chart: &memcached
        name: memcached
        release_name: memcached
        namespace: openstack
        install:
          no_hooks: false
        upgrade:
          no_hooks: false
        values:
          endpoints: *endpoints
        source:
          type: git
          location: git://github.com/gardlt/openstack-helm
          subpath: memcached
          reference: override-values
        dependencies:
          - *helm-toolkit

    - chart: &keystone
        name: keystone
        release_name: keystone
        namespace: openstack
        install:
          no_hooks: false
        upgrade:
          no_hooks: false
          pre:
              delete:
                  - name: keystone-db-sync
                    type: job
                  - name: keystone-db-init
                    type: job
          post:
              create:
                  - name: keystone-db-sync
                    type: job
                  - name: keystone-db-init
                    type: job
        values:
          endpoints: *endpoints
        source:
          type: git
          location: git://github.com/gardlt/openstack-helm
          subpath: keystone
          reference: override-values
        dependencies:
          - *helm-toolkit
